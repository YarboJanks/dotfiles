#!/usr/bin/env bash -e

files=( '.vim*' '.rspec' '.tmux*' '.zshrc' '.gitignore_global' )
dir=`pwd`

symlink () { 
  for dotfile; do
    # echo "Running: ln -sf $dir/$dotfile $HOME"
    echo "Symlinking $dotfile"
    `ln -sf $dir/$dotfile $HOME`
  done
}

symlink ${files[@]}

if ! [[ -e '.installed' ]]; then
  # install oh-my-zsh
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"

  # fetch submodules
  git submodule update --init --recursive

  # install vim plugins
  vim +PluginInstall +qall

  # set installation file so certain commands are skipped on the next run
  touch .installed
fi

